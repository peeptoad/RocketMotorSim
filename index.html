<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rocket Engine Performance Analyzer</title>
    <!-- Include Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Rocket Engine Performance Analyzer</h1>
    <div>
        <label for="initialPropellantMass">Initial Propellant Mass (grams):</label>
        <select id="initialPropellantMass">
            <!-- Options will be dynamically generated using JavaScript -->
        </select>
    </div>
    <div>
        <label for="initialRocketMass">Total Rocket Weight (grams):</label>
        <select id="initialRocketMass">
            <!-- Options will be dynamically generated using JavaScript -->
        </select>
    </div>
    <div>
        <label for="rocketDiameter">Rocket Diameter (meters):</label>
        <input type="number" id="rocketDiameter">
    </div>
    <div>
        <label for="rocketLength">Rocket Length (meters):</label>
        <input type="number" id="rocketLength">
    </div>
    <div>
        <label for="time">Time (seconds):</label>
        <input type="number" id="time">
        <label for="thrust">Thrust (lbs):</label>
        <input type="number" id="thrust">
        <button onclick="addData()">Add Data</button>
    </div>
    <div>
        <label for="ejectionTime">Ejection Charge Time (seconds):</label>
        <input type="number" id="ejectionTime">
        <button onclick="addEjectionCharge()">Add Ejection Charge</button>
    </div>
    <div>
        <button onclick="removeLastDataPoint()">Remove Last Data Point</button>
        <button onclick="calculateMetrics()">Calculate Metrics</button>
    </div>
    <div>
        <canvas id="performanceChart" width="800" height="400"></canvas>
    </div>
    <div>
        <p>Maximum Thrust (lbs): <span id="maxThrust"></span></p>
        <p>Maximum Thrust (N): <span id="maxThrustNewton"></span></p>
        <p>Average Thrust (lbs): <span id="averageThrust"></span></p>
        <p>Average Thrust (N): <span id="averageThrustNewton"></span></p>
        <p>Burn Time (seconds): <span id="burnTime"></span></p>
        <p>Time from Burnout to Ejection (seconds): <span id="burnoutToEjectionTime"></span></p>
        <p>Total Duration (seconds): <span id="totalDuration"></span></p>
        <p>Total Impulse (lbs-sec): <span id="totalImpulseLbs"></span></p>
        <p>Total Impulse (N-sec): <span id="totalImpulseNewton"></span></p>
        <p>Mass Flow Rate (grams/second): <span id="massFlowRate"></span></p>
        <p>Total Impulse per Unit Mass (N-sec/gram): <span id="totalImpulsePerUnitMass"></span></p>
        <p>Specific Impulse (seconds): <span id="specificImpulse"></span></p>
        <p>Peak Acceleration (m/sÂ²): <span id="peakAcceleration"></span></p>
        <p>Altitude (meters): <span id="altitude"></span></p>
        <p>Speed (m/s): <span id="speed"></span></p>
    </div>

    <script>
        // Initialize arrays to store data
        let dataPoints = [{ time: 0, thrust: 0 }]; // Initial data point at (0, 0)

        // Initialize chart
        const ctx = document.getElementById('performanceChart').getContext('2d');
        const myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['0'], // Initial label at 0
                datasets: [{
                    label: 'Thrust (lbs)',
                    data: [0], // Initial data point at (0, 0)
                    borderColor: 'blue',
                    backgroundColor: 'rgba(0, 0, 255, 0.1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    x: {
                        type: 'linear',
                        position: 'bottom',
                        title: {
                            display: true,
                            text: 'Time (seconds)'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Thrust (lbs)'
                        }
                    }
                }
            }
        });

        // Generate options for initial propellant mass dropdown
        const initialPropellantMassDropdown = document.getElementById('initialPropellantMass');
        for (let i = 1; i <= 100; i++) {
            const option = document.createElement('option');
            option.value = i;
            option.textContent = `${i} grams`;
            initialPropellantMassDropdown.appendChild(option);
        }

        // Generate options for initial rocket mass dropdown
        const initialRocketMassDropdown = document.getElementById('initialRocketMass');
        for (let i = 0; i <= 5000; i++) {
            const option = document.createElement('option');
            option.value = i;
            option.textContent = `${i} grams`;
            initialRocketMassDropdown.appendChild(option);
        }
        
        // Function to add data to arrays and update chart
        function addData() {
            let timeInput = parseFloat(document.getElementById('time').value);
            let thrustInput = parseFloat(document.getElementById('thrust').value);
            
            dataPoints.push({
                time: timeInput,
                thrust: thrustInput
            });

            updateChart();
        }

        // Function to add ejection charge data point
        function addEjectionCharge() {
            let ejectionTime = parseFloat(document.getElementById('ejectionTime').value);
            
            // Add ejection charge data point with 0 thrust
            dataPoints.push({
                time: ejectionTime,
                thrust: 0
            });

            updateChart();
        }

        // Function to remove last data point from arrays and update chart
        function removeLastDataPoint() {
            dataPoints.pop();
            updateChart();
        }

        // Function to update chart with current data points
        function updateChart() {
            // Reset chart data
            myChart.data.labels = [];
            myChart.data.datasets[0].data = [];

            for (let i = 0; i < dataPoints.length; i++) {
                myChart.data.labels.push(dataPoints[i].time.toFixed(2)); // Round time to 2 decimal places
                myChart.data.datasets[0].data.push(dataPoints[i].thrust);
            }

            myChart.update();
        }

        // Function to calculate metrics and update UI
        function calculateMetrics() {
            // Calculate and display other metrics (max thrust, average thrust, burn time, etc.)

            // Calculate and display peak acceleration
            document.getElementById('peakAcceleration').textContent = calculatePeakAcceleration().toFixed(2);

            // Calculate and display altitude and speed
            let altitudeSpeed = calculateAltitudeAndSpeed();
            document.getElementById('altitude').textContent = altitudeSpeed.altitude.toFixed(2);
            document.getElementById('speed').textContent = altitudeSpeed.speed.toFixed(2);
        }

        // Function to calculate peak acceleration
        function calculatePeakAcceleration() {
            let maxAcceleration = 0;
            for (let i = 0; i < dataPoints.length; i++) {
                let thrust = dataPoints[i].thrust;
                let totalRocketMass = calculateTotalRocketMassAtTime(i); // Calculate total mass of the rocket at this time
                let acceleration = thrust / totalRocketMass;
                if (acceleration > maxAcceleration) {
                    maxAcceleration = acceleration;
                }
            }
            return maxAcceleration;
        }

        // Function to calculate total mass of the rocket at a specific time index
        function calculateTotalRocketMassAtTime(index) {
            let initialRocketMass = parseFloat(document.getElementById('initialRocketMass').value);
            let initialPropellantMass = parseFloat(document.getElementById('initialPropellantMass').value);
            let burnTime = dataPoints[index].time;
            let propellantMassConsumed = (initialPropellantMass / burnTime) * dataPoints[index].time;
            return initialRocketMass - propellantMassConsumed;
        }

        // Function to calculate altitude and speed
        function calculateAltitudeAndSpeed() {
            const initialRocketMass = parseFloat(document.getElementById('initialRocketMass').value); // Initial rocket mass in grams
            const initialPropellantMass = parseFloat(document.getElementById('initialPropellantMass').value); // Initial propellant mass in grams
            const rocketDiameter = parseFloat(document.getElementById('rocketDiameter').value); // Rocket diameter in meters
            const rocketLength = parseFloat(document.getElementById('rocketLength').value); // Rocket length in meters
            const g = 9.81; // Acceleration due to gravity in m/s^2
            const airDensity = 1.225; // Average air density at sea level in kg/m^3 (can be adjusted)
            const dragCoefficient = 0.3; // Drag coefficient (depends on rocket design)

            let altitude = 0; // Initial altitude in meters
            let speed = 0; // Initial speed in meters per second

            // Time step for numerical integration (in seconds)
            const deltaTime = 0.1; // Adjust as needed for simulation accuracy

            for (let i = 1; i < dataPoints.length; i++) {
                // Calculate mass of the rocket at this time
                const time = dataPoints[i].time;
                const propellantMassConsumed = (initialPropellantMass / time) * dataPoints[i].time;
                const rocketMass = initialRocketMass - propellantMassConsumed;

                // Calculate thrust force (assuming constant thrust)
                const thrust = dataPoints[i].thrust * 0.453592; // Convert thrust from lbs to N

                // Calculate gravity force
                const gravityForce = rocketMass * g;

                // Calculate drag force using drag equation: F_drag = 0.5 * air_density * velocity^2 * drag_coefficient * cross-sectional_area
                const crossSectionalArea = Math.PI * Math.pow(rocketDiameter / 2, 2); // Cross-sectional area in square meters
                const dragForce = 0.5 * airDensity * Math.pow(speed, 2) * dragCoefficient * crossSectionalArea;

                // Calculate net force on the rocket
                const netForce = thrust - gravityForce - dragForce;

                // Calculate acceleration (Newton's second law: F = ma)
                const acceleration = netForce / rocketMass;

                // Update speed and altitude using numerical integration
                speed += acceleration * deltaTime;
                altitude += speed * deltaTime;

                // Display speed and altitude (for demonstration purposes)
                console.log(`Time: ${time.toFixed(2)}s, Speed: ${speed.toFixed(2)}m/s, Altitude: ${altitude.toFixed(2)}m`);
            }

            return { altitude: altitude, speed: speed };
        }
    </script>
</body>
</html>


